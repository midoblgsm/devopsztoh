<p>Prometheus is an open-source systems monitoring and alerting toolkit. Since its inception in 2012, many companies and organizations have adopted Prometheus, and the project has a very active developer and user community. It is now a standalone open source project and maintained independently of any company. To emphasize this, and to clarify the project's governance structure, Prometheus joined the Cloud Native Computing Foundation in 2016 as the second hosted project, after Kubernetes.</p>
<p>After our setup, you should be able to access prometheus at&nbsp;<a href="http://prometheus.myistio.com:31519/" target="_blank">http://prometheus.myistio.com:31519/</a>. The dashboard will look like:</p>
<p><img height="859" width="1424" src="/static/Screen_Shot_2020-06-03_at_5.43.47_PM.png" alt="prom" /></p>
<p>Prometheus has a query language called promql. You can use it to query the data being collected about your service mesh or about kubernetes.</p>
<p>For example we can run the following to get the cpu&nbsp;usage for&nbsp;containers:</p>
<pre class=" language-bash" style="text-rendering: optimizelegibility; font-family: Iosevka, monospace; font-size: 16px; margin-top: 0px; margin-bottom: 1.5em; padding: 0.5rem; border: 0px; outline: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: 1.4em; vertical-align: baseline; color: #3d3c3c; box-sizing: border-box; background: #efeeee; overflow-x: auto;"><code class=" language-bash" style="text-rendering: optimizelegibility; font-family: Iosevka, monospace; font-size: 1em; margin: 0px; border: 0px; outline: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; line-height: 1.4em; vertical-align: baseline; border-radius: 0px; background-image: initial; color: #313131; box-sizing: border-box;">sum(<br style="box-sizing: inherit; color: rgba(0, 0, 0, 0.84); font-family: Menlo, Monaco, 'Courier New', Courier, monospace; letter-spacing: -0.352px; background-color: rgba(0, 0, 0, 0.05);" /><span style="color: rgba(0, 0, 0, 0.84); font-family: Menlo, Monaco, 'Courier New', Courier, monospace; letter-spacing: -0.352px; background-color: rgba(0, 0, 0, 0.05);"> rate(</span><span class="kf lc" style="box-sizing: inherit; font-family: Menlo, Monaco, 'Courier New', Courier, monospace; font-weight: bold; color: rgba(0, 0, 0, 0.84); letter-spacing: -0.352px; background-color: rgba(0, 0, 0, 0.05);">container_cpu_usage_seconds_total</span><span style="color: rgba(0, 0, 0, 0.84); font-family: Menlo, Monaco, 'Courier New', Courier, monospace; letter-spacing: -0.352px; background-color: rgba(0, 0, 0, 0.05);">[5m]))</span><br style="box-sizing: inherit; color: rgba(0, 0, 0, 0.84); font-family: Menlo, Monaco, 'Courier New', Courier, monospace; letter-spacing: -0.352px; background-color: rgba(0, 0, 0, 0.05);" /><span style="color: rgba(0, 0, 0, 0.84); font-family: Menlo, Monaco, 'Courier New', Courier, monospace; letter-spacing: -0.352px; background-color: rgba(0, 0, 0, 0.05);">by (container_name)</span><br style="text-rendering: optimizelegibility; line-height: 1.4em;" /></code></pre>
<p style="text-rendering: optimizelegibility; margin-top: 0px; margin-right: 0px; margin-left: 0px; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; font-size: 16px; font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif; vertical-align: baseline; color: #313131;">Prometheus is very good at collecting time series data about your cluster and services but it is not the best tool for visualization. It is often used in conjunction with another tool for the visualization such as grafana. Grafana is very useful to represent the data with different types of graphs, histograms, heat maps and other types of visualizations. With istio, you get a grafana instance that allows you to visualize monitoring data about your service mesh.</p>
<p style="text-rendering: optimizelegibility; margin-top: 0px; margin-right: 0px; margin-left: 0px; padding: 0px; border: 0px; outline: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; font-size: 16px; font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif; vertical-align: baseline; color: #313131;"><img height="859" width="1424" src="/static/Screen_Shot_2020-06-03_at_5.44.22_PM.png" alt="grafana" /></p>
<p>By default, istio sets up different dashboards related to our services and how the traffic is going between them. We can also add more visualization using promql to get the data from prometheus and visualize them in different forms.</p>